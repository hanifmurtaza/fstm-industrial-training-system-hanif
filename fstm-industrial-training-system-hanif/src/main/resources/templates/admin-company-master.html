<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Admin • Company Master</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" />
    <style>
        body { background:#f5f7fa }
        .navbar { background:#0d6efd }
        .navbar-brand, .nav-link { color:#fff !important }
        .card { border-radius:12px; box-shadow:0 4px 8px rgba(0,0,0,.06) }
    </style>
</head>
<body>

<nav class="navbar navbar-expand-lg">
    <div class="container-fluid">
        <a class="navbar-brand" href="/admin/dashboard">Admin Panel</a>
        <div class="collapse navbar-collapse">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item"><a class="nav-link" href="/admin/students">Students</a></li>
                <li class="nav-item"><a class="nav-link" href="/admin/lecturers">Lecturers</a></li>
                <li class="nav-item"><a class="nav-link" href="/admin/documents">Documents</a></li>
                <li class="nav-item"><a class="nav-link" href="/admin/companies">Companies (Submissions)</a></li>
                <li class="nav-item"><a class="nav-link active" href="/admin/company-master">Company Master</a></li>
                <li class="nav-item"><a class="nav-link" href="/admin/evaluations">Evaluations</a></li>
                <li class="nav-item"><a class="nav-link" href="/logout">Logout</a></li>
            </ul>
        </div>
    </div>
</nav>

<div class="container py-4">

    <div class="d-flex align-items-center justify-content-between mb-3">
        <h3 class="m-0">Company Master</h3>
        <form class="d-flex" method="get" th:action="@{/admin/company-master}">
            <input name="q" class="form-control me-2" placeholder="Search by name" th:value="${q}">
            <button class="btn btn-outline-light bg-primary text-white">
                <i class="bi bi-search"></i>
            </button>
        </form>
    </div>

    <div class="card p-0 mb-4">
        <div class="table-responsive">
            <table class="table table-hover align-middle m-0">
                <thead class="table-light">
                <tr>
                    <th style="width:80px;">#</th>
                    <th>Name</th>
                    <th>Sector</th>
                    <th style="width:140px;">Allowance</th>
                    <th style="width:120px;">Acc.</th>
                    <th style="width:120px;">Actions</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="c, i : ${companies.content}">
                    <td th:text="${companies.number * companies.size + i.index + 1}">1</td>
                    <td>
                        <div class="fw-semibold" th:text="${c.name}">Company</div>
                        <div class="small text-muted" th:text="${c.address}">Address</div>
                    </td>
                    <td th:text="${c.sector} ?: '-'">-</td>
                    <td th:text="${c.typicalAllowance} ?: '-'">-</td>
                    <td th:text="${c.accommodation} ? 'Yes' : 'No'">No</td>
                    <td>
                        <form th:action="@{/admin/company-master/{id}/delete(id=${c.id})}" method="post"
                              onsubmit="return confirm('Delete this company?');">
                            <button class="btn btn-outline-danger btn-sm"><i class="bi bi-trash"></i></button>
                        </form>
                    </td>
                </tr>
                <tr th:if="${companies.totalElements == 0}">
                    <td colspan="6" class="text-center text-muted py-4">
                        <i class="bi bi-buildings"></i> No master companies yet.
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <div class="d-flex justify-content-between align-items-center p-3">
            <div class="text-muted">
                <span th:text="'Page ' + ${companies.number + 1} + ' / ' + ${companies.totalPages}"></span>
            </div>
            <div class="d-flex gap-2">
                <a class="btn btn-outline-secondary btn-sm" th:if="${!companies.first}"
                   th:href="@{/admin/company-master(page=${companies.number-1},q=${q})}">← Prev</a>
                <a class="btn btn-outline-secondary btn-sm" th:if="${!companies.last}"
                   th:href="@{/admin/company-master(page=${companies.number+1},q=${q})}">Next →</a>
            </div>
        </div>
    </div>

    <div class="card p-4">
        <h5 class="mb-3"><i class="bi bi-plus-lg"></i> Add / Update Company</h5>
        <form method="post" th:action="@{/admin/company-master}">
            <input type="hidden" name="id">
            <div class="row g-3">
                <div class="col-md-6">
                    <label class="form-label">Name</label>
                    <input class="form-control" name="name" required>
                </div>
                <div class="col-md-6">
                    <label class="form-label">Sector</label>
                    <input class="form-control" name="sector">
                </div>
                <div class="col-md-12">
                    <label class="form-label">Address</label>
                    <input class="form-control" name="address">
                </div>
                <div class="col-md-6">
                    <label class="form-label">Default Job Scope</label>
                    <input class="form-control" name="defaultJobScope">
                </div>
                <div class="col-md-3">
                    <label class="form-label">Typical Allowance</label>
                    <input class="form-control" name="typicalAllowance" type="number" step="0.01">
                </div>
                <div class="col-md-3 d-flex align-items-end">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" name="accommodation" value="true" id="acc">
                        <label class="form-check-label" for="acc">Accommodation</label>
                    </div>
                </div>
            </div>
            <div class="mt-3">
                <button class="btn btn-primary">Save</button>
            </div>
        </form>
    </div>

</div>
</body>
</html>
