<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin • Evaluation Detail</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body { background:#f5f7fa; }
        .card-soft { border-radius:16px; box-shadow:0 10px 26px rgba(15,23,42,.08); border:1px solid rgba(148,163,184,.25); }
        .pill { display:inline-flex; align-items:center; gap:.4rem; padding:.35rem .7rem; border-radius:999px; font-weight:700; font-size:.75rem; }
        .pill-ok { background:#E6F4EA; color:#1F7A39; border:1px solid rgba(31,122,57,.15); }
        .pill-na { background:#EEF2F7; color:#475569; border:1px solid rgba(71,85,105,.18); }
        .muted { color:#64748b; }
        .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    </style>
</head>
<body>

<div class="container mt-5" style="max-width:1100px;">

    <div class="d-flex justify-content-between align-items-center mb-3">
        <div>
            <h3 class="mb-0" th:text="${student.name != null ? student.name : student.username}">Student</h3>
            <div class="text-muted"
                 th:text="${'Matric: ' + (student.studentId != null ? student.studentId : '-') + ' • Session: ' + (student.session != null ? student.session : '-') }">
                Matric / Session
            </div>
        </div>
        <a class="btn btn-primary" th:href="@{/admin/evaluations}">⬅ Back</a>
    </div>

    <!-- Context -->
    <div class="card mb-4 card-soft">
        <div class="card-body">
            <h5 class="mb-3">Evaluation Context</h5>

            <div class="row">
                <div class="col-md-4">
                    <div class="fw-semibold">Industry Supervisor</div>
                    <div th:text="${industrySupervisor != null ? industrySupervisor.name : '-'}">-</div>
                </div>

                <div class="col-md-4">
                    <div class="fw-semibold">Company</div>
                    <div th:text="${company != null ? company.name : '-'}">-</div>
                </div>

                <div class="col-md-4">
                    <div class="fw-semibold">Visiting Lecturer</div>
                    <div th:text="${visitingLecturer != null ? visitingLecturer.name : '-'}">-</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scores -->
    <div class="card card-soft">
        <div class="card-body">

            <h5 class="mb-3">Scores (40 + 40 + 10 + 10)</h5>

            <div class="row g-3">

                <!-- Visiting Lecturer (40) -->
                <div class="col-md-6">
                    <div class="p-3 border rounded bg-white h-100">
                        <div class="fw-semibold mb-2">Visiting Lecturer (40)</div>

                        <div class="small">Reflection: <span th:text="${visitEval != null ? (visitEval.reflectionLikert != null ? visitEval.reflectionLikert*2 : 0) : 0}">0</span> / 10</div>
                        <div class="small">Engagement: <span th:text="${visitEval != null ? (visitEval.engagementLikert != null ? visitEval.engagementLikert*2 : 0) : 0}">0</span> / 10</div>
                        <div class="small">Placement Suitability: <span th:text="${visitEval != null ? (visitEval.placementSuitabilityLikert != null ? visitEval.placementSuitabilityLikert : 0) : 0}">0</span> / 5</div>
                        <div class="small">Logbook Review: <span th:text="${visitEval != null ? (visitEval.logbookLikert != null ? visitEval.logbookLikert : 0) : 0}">0</span> / 5</div>
                        <div class="small">Overall (Lecturer): <span th:text="${visitEval != null ? (visitEval.lecturerOverallLikert != null ? visitEval.lecturerOverallLikert*2 : 0) : 0}">0</span> / 10</div>

                        <hr>
                        <div class="fw-semibold">
                            Total:
                            <span th:text="${vl40}">0</span> / 40
                        </div>

                        <hr class="my-3">
                        <div class="fw-semibold mb-1">Lecturer Comments</div>

                        <div class="small">
                            <div class="muted mb-1">Discussion Summary</div>
                            <div class="border rounded p-2 bg-light"
                                 th:text="${visitEval != null && visitEval.discussionSummary != null && !#strings.isEmpty(visitEval.discussionSummary) ? visitEval.discussionSummary : '—'}">—</div>
                        </div>

                        <div class="small mt-2">
                            <div class="muted mb-1">Overall Observation</div>
                            <div class="border rounded p-2 bg-light"
                                 th:text="${visitEval != null && visitEval.overallObservation != null && !#strings.isEmpty(visitEval.overallObservation) ? visitEval.overallObservation : '—'}">—</div>
                        </div>

                        <div class="small mt-2">
                            <div class="muted mb-1">Additional Remarks</div>
                            <div class="border rounded p-2 bg-light"
                                 th:text="${visitEval != null && visitEval.additionalRemarks != null && !#strings.isEmpty(visitEval.additionalRemarks) ? visitEval.additionalRemarks : '—'}">—</div>
                        </div>

                    </div>
                </div>

                <!-- Industry Supervisor (40) -->
                <div class="col-md-6">
                    <div class="p-3 border rounded bg-white h-100">
                        <div class="fw-semibold mb-2">Industry Supervisor (40)</div>

                        <div>Attributes (30): <span th:text="${sa != null && sa.isAttributes30 != null ? sa.isAttributes30 : 0}">0</span> / 30</div>
                        <div>Overall (10): <span th:text="${sa != null && sa.isOverall10 != null ? sa.isOverall10 : 0}">0</span> / 10</div>

                        <hr>
                        <div class="fw-semibold">
                            Total:
                            <span th:text="${industry40}">0</span> / 40
                        </div>

                        <hr class="my-3">
                        <div class="fw-semibold mb-1">Supervisor Comments</div>
                        <div class="border rounded p-2 bg-light small"
                             th:text="${supEval != null && supEval.overallComment != null && !#strings.isEmpty(supEval.overallComment) ? supEval.overallComment : '—'}">—</div>

                        <div class="small mt-2" th:if="${supEval != null && supEval.careerOpportunityRemark != null && !#strings.isEmpty(supEval.careerOpportunityRemark)}">
                            <div class="muted mb-1">Career Opportunity Remark</div>
                            <div class="border rounded p-2 bg-light"
                                 th:text="${supEval.careerOpportunityRemark}">—</div>
                        </div>

                    </div>
                </div>

                <!-- Logbook (10) -->
                <div class="col-md-6">
                    <div class="p-3 border rounded bg-white">
                        <div class="fw-semibold mb-2">Logbook (10)</div>
                        <span class="pill pill-na" th:if="${logbook10 == null}">PENDING</span>
                        <span class="pill pill-ok" th:if="${logbook10 != null}" th:text="${logbook10 + ' / 10'}">0 / 10</span>
                        <div class="muted small mt-2">Backend scoring will be connected after faculty confirms marking scheme.</div>
                    </div>
                </div>

                <!-- Final Report (10) -->
                <div class="col-md-6">
                    <div class="p-3 border rounded bg-white">
                        <div class="fw-semibold mb-2">Final Report (10)</div>
                        <div>Written (5): <span th:text="${sa != null && sa.adminReportWritten5 != null ? sa.adminReportWritten5 : 0}">0</span> / 5</div>
                        <div>Video (5): <span th:text="${sa != null && sa.adminReportVideo5 != null ? sa.adminReportVideo5 : 0}">0</span> / 5</div>
                        <hr>
                        <div class="fw-semibold">Total: <span th:text="${report10}">0</span> / 10</div>
                    </div>
                </div>

            </div>

            <hr class="my-4">

            <!-- Overall Summary -->
            <div class="d-flex flex-wrap gap-3">
                <div class="p-3 border rounded bg-white">
                    <div class="text-muted small">Overall Total (out of 100)</div>
                    <div class="h5 mb-0" th:text="${#numbers.formatDecimal(total100New, 1, 2)}">0.00</div>
                </div>

                <div class="p-3 border rounded bg-white">
                    <div class="text-muted small">Grade</div>
                    <div class="h5 mb-0" th:text="${gradeNew}">-</div>
                </div>

                <div class="p-3 border rounded bg-white">
                    <div class="text-muted small">Status</div>
                    <div class="h5 mb-0" th:text="${sa != null && sa.status != null ? sa.status : '-'}">-</div>
                </div>
            </div>

        </div>
    </div>

</div>

</body>
</html>
