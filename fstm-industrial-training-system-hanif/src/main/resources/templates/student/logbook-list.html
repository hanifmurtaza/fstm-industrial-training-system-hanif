<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout2}" lang="en">
<head>
  <title>View Logbook</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
</head>
<body>

<div layout:fragment="content">
  <h3 class="text-center fw-bold mb-4">ðŸ“– My Logbook Entries</h3>

  <div class="table-responsive">
    <table class="table table-bordered text-center align-middle">
      <thead class="table-primary">
      <tr>
        <th>#</th>
        <th>Week Start</th>
        <th style="min-width:260px;">Supervisor Endorsement</th>

        <!-- âœ… Hide VL endorsement column -->
        <!-- <th style="min-width:300px;">Visiting Lecturer Endorsement</th> -->

        <th>File</th>
        <th>Export</th>
        <th>Delete</th>
      </tr>
      </thead>

      <tbody>
      <tr th:each="entry, iterStat : ${logbookEntries}">
        <td th:text="${iterStat.index + 1}">1</td>

        <td th:text="${entry.weekStartDate}">2025-05-03</td>

        <!-- âœ… Supervisor endorsement: use status -->
        <td>
          <span th:if="${entry.status != null and entry.status.name() == 'APPROVED'}"
                class="text-success fw-semibold">
            <i class="bi bi-check-lg"></i> Endorsed
          </span>

          <span th:if="${entry.status == null or entry.status.name() == 'PENDING'}"
                class="text-muted fw-semibold">
            <i class="bi bi-hourglass-split"></i> Pending
          </span>

          <span th:if="${entry.status != null and entry.status.name() == 'REJECTED'}"
                class="text-danger fw-semibold">
            <i class="bi bi-x-lg"></i> Rejected
          </span>
        </td>

        <!-- âœ… Visiting Lecturer endorsement hidden -->
        <!--
        <td>
          <span th:if="${entry.endorsedByLecturer}"
                class="text-success fw-semibold">
            <i class="bi bi-check-lg"></i> Endorsed
          </span>
          <span th:unless="${entry.endorsedByLecturer}"
                class="text-danger fw-semibold">
            <i class="bi bi-x-lg"></i> Not Endorsed
          </span>
        </td>
        -->

        <!-- âœ… File View/Download -->
        <td>
          <span th:if="${entry.photoPath == null}" class="text-muted">No file</span>

          <div th:if="${entry.photoPath != null}" class="d-flex gap-2 justify-content-center flex-wrap">
            <a th:href="${entry.photoPath}"
               class="btn btn-sm btn-outline-primary"
               target="_blank">
              <i class="bi bi-eye"></i> View
            </a>

            <a th:href="${entry.photoPath}"
               class="btn btn-sm btn-outline-secondary"
               download>
              <i class="bi bi-download"></i> Download
            </a>
          </div>
        </td>

        <!-- Export PDF -->
        <td>
          <a th:href="@{'/student/logbook/download/' + ${entry.id}}"
             class="btn btn-sm btn-outline-primary">
            <i class="bi bi-file-earmark-pdf"></i> Export
          </a>
        </td>

        <!-- Delete -->
        <td>
          <a th:href="@{'/student/logbook/delete/' + ${entry.id}}"
             onclick="return confirm('Are you sure you want to delete this entry?');"
             class="btn btn-sm btn-outline-danger">
            <i class="bi bi-trash"></i> Delete
          </a>
        </td>

      </tr>

      <tr th:if="${#lists.isEmpty(logbookEntries)}">
        <td colspan="6" class="text-muted py-4">No logbook entries found.</td>
      </tr>

      </tbody>
    </table>
  </div>
</div>

</body>
</html>