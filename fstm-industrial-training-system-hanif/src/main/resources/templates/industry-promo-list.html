<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Industry – Opportunities</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body{font-family:'Inter',sans-serif;background:#f5f7fa}
        .navbar{background:#0d6efd}.navbar-brand,.nav-link{color:#fff!important;font-weight:500}
        .card{border-radius:12px;box-shadow:0 4px 8px rgba(0,0,0,.08)}
        .status-badge{font-size:.75rem}
        img.thumb{width:52px;height:36px;object-fit:cover;border-radius:6px}
    </style>
</head>
<body>
<nav class="navbar navbar-expand-lg">
    <div class="container-fluid">
        <a class="navbar-brand" href="/industry/dashboard">Industry Supervisor</a>
        <ul class="navbar-nav ms-auto">
            <li class="nav-item"><a class="nav-link" href="/industry/logbooks">Logbooks</a></li>
            <li class="nav-item"><a class="nav-link" href="/industry/placements">Placements</a></li>
            <li class="nav-item"><a class="nav-link" href="/industry/evaluations">Evaluations</a></li>
            <li class="nav-item"><a class="nav-link fw-semibold" href="/industry/opportunities">Opportunities</a></li>
            <li class="nav-item"><a class="nav-link" href="/logout">Logout</a></li>
        </ul>
    </div>
</nav>

<div class="container py-4">
    <div class="d-flex align-items-center mb-3">
        <h4 class="me-auto mb-0">My Opportunity Posts</h4>
        <a href="/industry/opportunities/new" class="btn btn-primary">+ New Post</a>
    </div>

    <form class="row g-2 mb-3" method="get" action="/industry/opportunities">
        <div class="col-auto">
            <select class="form-select" name="status">
                <option th:selected="${status == null}" value="">All statuses</option>
                <option th:selected="${status?.name() == 'DRAFT'}" value="DRAFT">Draft</option>
                <option th:selected="${status?.name() == 'PUBLISHED'}" value="PUBLISHED">Published</option>
                <option th:selected="${status?.name() == 'ARCHIVED'}" value="ARCHIVED">Archived</option>
            </select>
        </div>
        <div class="col-auto">
            <button class="btn btn-outline-primary">Apply</button>
        </div>
    </form>

    <div class="card">
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-hover mb-0">
                    <thead class="table-light">
                    <tr>
                        <th style="width:60px">ID</th>
                        <th style="width:64px">Img</th>
                        <th>Title</th>
                        <th>Company</th>
                        <th>Location</th>
                        <th>Status</th>
                        <th style="width:220px">Actions</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="p : ${items.content}">
                        <td th:text="${p.id}">1</td>
                        <td>
                            <img class="thumb" th:if="${p.imageUrl}" th:src="${p.imageUrl}" alt="">
                        </td>
                        <td>
                            <a th:href="@{'/industry/opportunities/' + ${p.id}}" th:text="${p.title}">Title</a>
                            <div class="text-muted small" th:text="${p.roleType} + ' · ' + ${p.workMode}">Internship · Onsite</div>
                        </td>
                        <td th:text="${p.companyName}">Company</td>
                        <td th:text="${p.location}">Location</td>
                        <td>
                            <span class="badge text-bg-secondary status-badge" th:if="${p.status.name()=='DRAFT'}">DRAFT</span>
                            <span class="badge text-bg-success status-badge" th:if="${p.status.name()=='PUBLISHED'}">PUBLISHED</span>
                            <span class="badge text-bg-dark status-badge" th:if="${p.status.name()=='ARCHIVED'}">ARCHIVED</span>
                        </td>
                        <td>
                            <a class="btn btn-sm btn-outline-primary" th:href="@{'/industry/opportunities/' + ${p.id}}">Edit</a>
                            <form th:action="@{'/industry/opportunities/' + ${p.id} + '/publish'}" method="post" class="d-inline"
                                  th:if="${p.status.name() != 'PUBLISHED'}">
                                <button class="btn btn-sm btn-success">Publish</button>
                            </form>
                            <form th:action="@{'/industry/opportunities/' + ${p.id} + '/archive'}" method="post" class="d-inline"
                                  th:if="${p.status.name() != 'ARCHIVED'}">
                                <button class="btn btn-sm btn-outline-secondary">Archive</button>
                            </form>
                        </td>
                    </tr>
                    <tr th:if="${items.content.size() == 0}">
                        <td colspan="7" class="text-center text-muted py-4">No posts found.</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="d-flex justify-content-between align-items-center mt-3">
        <div class="text-muted small" th:text="'Total: ' + ${items.totalElements} + ' items'">Total</div>
        <div>
            <a class="btn btn-sm btn-outline-primary me-1"
               th:href="@{|/industry/opportunities?page=${items.number - 1}&size=${items.size}${status!=null?'&status='+status.name():''}|}"
               th:classappend="${items.first} ? ' disabled'">Prev</a>
            <a class="btn btn-sm btn-outline-primary"
               th:href="@{|/industry/opportunities?page=${items.number + 1}&size=${items.size}${status!=null?'&status='+status.name():''}|}"
               th:classappend="${items.last} ? ' disabled'">Next</a>
        </div>
    </div>
</div>
</body>
</html>
