<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout2}" lang="en">
<head>
  <title>Student Dashboard</title>
</head>
<body>
<div layout:fragment="content">

  <!-- Welcome -->
  <h2 class="fw-bold mb-4 text-center">
    Welcome <span th:text="${name}">Student Name</span> üéì
  </h2>

  <!-- Weekly Logbook Reminder -->
  <div class="alert alert-warning text-center">
    <div class="fw-bold mb-1">üìù Weekly Logbook Reminder</div>
    <div class="small">
      Please submit your logbook <b>every week</b>
    </div>
  </div>

  <!-- Visit notice -->
  <div th:if="${visitSchedule != null}" class="alert alert-info text-center">
    <p class="mb-3">
      Lecturer will visit on
      <strong th:text="${visitSchedule.visitDate}">2025-05-01</strong>
      at
      <strong th:text="${visitSchedule.visitTime}">15:00</strong>
      via
      <strong th:text="${visitSchedule.mode}">Virtual</strong>.
    </p>

    <div th:if="${visitSchedule.status == 'Pending'}"
         class="d-flex justify-content-center gap-2">
      <form th:action="@{/student/visit/confirm}" method="post">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
        <input type="hidden" name="visitId" th:value="${visitSchedule.id}">
        <button type="submit" class="btn btn-success btn-sm">Confirm</button>
      </form>

      <form th:action="@{/student/visit/reschedule}" method="post">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
        <input type="hidden" name="visitId" th:value="${visitSchedule.id}">
        <button type="submit" class="btn btn-warning btn-sm">Request Reschedule</button>
      </form>
    </div>

    <div th:if="${visitSchedule.status == 'Confirmed'}" class="text-success fw-bold">
      ‚úî You have confirmed this visit.
    </div>

    <div th:if="${visitSchedule.status == 'RescheduleRequested'}" class="text-warning fw-bold">
      ‚è≥ You have requested a reschedule.
    </div>
  </div>

  <!-- If no visit schedule -->
  <div th:if="${visitSchedule == null}" class="alert alert-secondary text-center">
    No upcoming lecturer visit has been scheduled yet.
  </div>

  <!-- =======================
     Announcements
     ======================= -->
  <div class="container px-0 my-4">
    <div class="card shadow-sm border-0">
      <div class="card-body p-4">
        <div class="d-flex align-items-center justify-content-between mb-3">
          <h5 class="fw-bold m-0">üì¢ Announcements</h5>
          <span class="badge bg-light text-muted border">Latest Updates</span>
        </div>

        <!-- When announcements exist -->
        <div th:if="${announcements != null and !#lists.isEmpty(announcements)}">
          <ul class="list-group list-group-flush">
            <li class="list-group-item px-0 py-3" th:each="a : ${announcements}">
              <div class="d-flex">
                <div class="me-2 mt-1">
                  <i class="bi bi-file-earmark-arrow-down text-primary"></i>
                </div>
                <div class="flex-grow-1">
                  <a class="link-primary text-decoration-none fw-semibold"
                     th:href="@{'/announcement/download/' + ${a.id}}"
                     th:text="${a.title}">Announcement title</a>
                  <div class="text-muted small" th:text="${a.originalName}">file.pdf</div>
                  <div class="text-muted small mt-1">
                    <i class="bi bi-calendar-event me-1"></i>
                    <span th:text="${#temporals.format(a.uploadedAt, 'yyyy-MM-dd HH:mm')}">2025-10-26</span>
                  </div>
                </div>
              </div>
            </li>
          </ul>
        </div>

        <!-- When no announcements -->
        <div th:if="${announcements == null or #lists.isEmpty(announcements)}">
          <div class="alert alert-light border mb-0">
            <div class="small text-muted">
              No announcements at the moment.
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- Switch Company Policy (embedded on dashboard) -->
  <!-- Switch Company Policy (embedded on dashboard) -->
  <div class="container px-0 py-2">
    <div class="card shadow-sm border-0">
      <div class="card-body p-4">
        <h4 class="fw-bold mb-1">Changing Industrial Training Company</h4>
        <p class="text-muted mb-4">
          Please read the policy below. If you intend to switch your Industrial Training company, you must follow the Faculty procedure.
        </p>

        <div class="border rounded p-3 bg-light" style="max-height: 420px; overflow:auto;">
          <h6 class="fw-bold mb-2">Policy on Conditions for Changing Industrial Training Placement</h6>

          <div class="small">
            <p class="mb-2">
              <b>1. Conditions Before Commencing Industrial Training</b><br>
              Students must complete all prerequisite courses before they are allowed to undergo industrial training.
              The selection of the industrial training placement is based on the student‚Äôs own choice and must be formally endorsed by the Faculty.
              Any application to change the industrial training placement after official confirmation is not permitted unless there are very strong and reasonable grounds supported by credible evidence.
            </p>

            <p class="mb-2"><b>2. Categories for Approval of Industrial Training Placement Change</b></p>
            <p class="mb-2">
              Approval is based on three categories: <b>A) Critical</b>, <b>B) Considerable</b>, and <b>C) Not Approved</b>.
              Applications under the Considerable category may only be submitted after the student has completed three weeks of industrial training.
            </p>

            <p class="mb-2"><b>Category A: Critical</b></p>
            <ul class="mb-2">
              <li>Serious health issues such as chronic illness or severe injury (official medical letter)</li>
              <li>Sexual harassment at the industrial training workplace (employer/police report and evidence)</li>
              <li>Female students required to work night shifts without supervision (work schedule + complaint letter)</li>
            </ul>

            <p class="mb-2"><b>Category B: Considerable</b></p>
            <ul class="mb-2">
              <li>Location too far / no public transportation (proof + family support letter)</li>
              <li>Assigned tasks not aligned with level of study (complaint + employer confirmation)</li>
              <li>No supervision/monitoring by appointed supervisor (evidence + unsigned weekly reports)</li>
              <li>Serious personal issues involving family (official letter + verified documents)</li>
            </ul>

            <p class="mb-2"><b>Category C: Not Approved</b></p>
            <ul class="mb-2">
              <li>Feeling unhappy / placement uninteresting</li>
              <li>Transfer to follow friends</li>
              <li>Workload tiring/heavy</li>
              <li>Incompatibility with supervisor/staff</li>
              <li>Return hometown for cost saving/family commitments</li>
              <li>Another offer seems more attractive after confirmation</li>
            </ul>

            <p class="mb-0">
              <b>Student Declaration and Acknowledgement</b><br>
              Students must comply with all requirements, procedures, and implications outlined by the Faculty.
            </p>
          </div>
        </div>

        <div class="alert alert-light border mt-3 mb-0">
          <div class="small">
            If you need to proceed with a placement change request, please contact <b>Admin Faculty</b>.<br>
            <span class="text-muted">Email: ****CHANGEME****</span>
          </div>
        </div>

      </div>
    </div>
  </div>

</div>
</body>
</html>