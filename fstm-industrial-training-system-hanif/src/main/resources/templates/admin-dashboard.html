<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard - UPM Industrial Training</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
  <link th:href="@{/css/app.css}" rel="stylesheet">

  <style>
    /* Keep page consistent with login look */
    :root{ --border:#e5e7eb; --muted:#6b7280; }
    body{ background:#f5f7fa; }

    /* Blue header (kept) */
    .appbar{ background:#0d6efd; color:#fff; }
    .appbar a{ color:#fff; text-decoration:none; }
    .appbar .nav-link{ color:#fff; opacity:.9; }
    .appbar .nav-link:hover{ opacity:1; text-decoration:underline; }

    .container-narrow{ max-width:1240px; }

    /* Stat & feature grids */
    .stat-grid{ display:grid; grid-template-columns:repeat(4,1fr); gap:16px; }
    @media (max-width:1199.98px){ .stat-grid{ grid-template-columns:repeat(2,1fr); } }
    @media (max-width:575.98px){ .stat-grid{ grid-template-columns:1fr; } }
    .stat-card{ padding:14px 16px; border:1px solid var(--border); border-radius:16px; background:#fff; box-shadow:0 8px 18px rgba(0,0,0,.06); }
    .stat-card .label{ color:var(--muted); font-weight:600; font-size:.85rem; }
    .stat-card .value{ font-size:1.4rem; font-weight:800; line-height:1.2; }

    .callout-grid{ display:grid; grid-template-columns:repeat(4,1fr); gap:16px; }
    @media (max-width:1199.98px){ .callout-grid{ grid-template-columns:repeat(2,1fr); } }
    @media (max-width:575.98px){ .callout-grid{ grid-template-columns:1fr; } }
    .callout-grid .card{ border-radius:16px; }

    .feature-grid{ display:grid; grid-template-columns:repeat(3,1fr); gap:20px; }
    @media (max-width:1199.98px){ .feature-grid{ grid-template-columns:repeat(2,1fr); } }
    @media (max-width:767.98px){ .feature-grid{ grid-template-columns:1fr; } }
    .feature-card h5{ font-weight:700; }
    .feature-card .lead{ color:var(--muted); font-size:.95rem; }

    /* Footer spacing now that chart is gone */
    .page-end{ height:12px; }
  </style>
</head>
<body>

<!-- Blue navbar/header (kept) -->
<nav class="navbar navbar-expand-lg appbar">
  <div class="container container-narrow">
    <a class="navbar-brand d-flex align-items-center gap-2" th:href="@{/admin/dashboard}">
      <img th:src="@{/Picture1.png}" alt="UPM" style="height:28px">
      <span>Admin Panel â€¢ UPM Industrial Training</span>
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div id="nav" class="collapse navbar-collapse">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a th:href="@{/admin/students}" class="nav-link">Students</a></li>
        <li class="nav-item"><a th:href="@{/admin/lecturers}" class="nav-link">Lecturers</a></li>
        <li class="nav-item"><a th:href="@{/admin/evaluations}" class="nav-link">Evaluations</a></li>
        <li class="nav-item"><a th:href="@{/admin/companies}" class="nav-link">Companies</a></li>
        <li class="nav-item"><a th:href="@{/admin/company-master}" class="nav-link">Company Master</a></li>
        <li class="nav-item"><a th:href="@{/admin/company-info(status='PENDING')}" class="nav-link">Submissions</a></li>
        <li class="nav-item"><a th:href="@{/admin/placements}" class="nav-link">Placements</a></li>
        <li class="nav-item"><a th:href="@{/logout}" class="nav-link">Logout</a></li>
      </ul>
    </div>
  </div>
</nav>

<main class="container container-narrow py-4">
  <h1 class="h4 mb-3">Welcome, Admin <span aria-hidden="true">ðŸŽ“</span></h1>

  <!-- KPIs -->
  <section class="stat-grid mb-3">
    <div class="stat-card">
      <div class="label">Total Students</div>
      <div class="value" th:text="${studentCount} ?: 0">0</div>
    </div>
    <div class="stat-card">
      <div class="label">Companies</div>
      <div class="value" th:text="${companyCount} ?: 0">0</div>
    </div>
    <div class="stat-card">
      <div class="label">Evaluations</div>
      <div class="value" th:text="${evalCount} ?: 0">0</div>
    </div>
    <div class="stat-card">
      <div class="label">Documents</div>
      <div class="value" th:text="${documentCount} ?: 0">0</div>
    </div>
  </section>

  <!-- Review queues -->
  <section class="callout-grid mb-4">
    <div class="card p-3" th:if="${awaitingApproval != null}">
      <div class="d-flex align-items-center justify-content-between">
        <div>
          <div class="text-muted fw-semibold">Placements Awaiting Admin</div>
          <div class="fs-4 fw-bold" th:text="${awaitingApproval} ?: 0">0</div>
        </div>
        <a class="btn btn-outline-primary" th:href="@{/admin/placements(status='AWAITING_ADMIN')}">Review</a>
      </div>
    </div>

    <div class="card p-3" th:if="${pendingCompanyInfo != null}">
      <div class="d-flex align-items-center justify-content-between">
        <div>
          <div class="text-muted fw-semibold">Company Submissions</div>
          <div class="fs-4 fw-bold" th:text="${pendingCompanyInfo} ?: 0">0</div>
        </div>
        <a class="btn btn-outline-primary" th:href="@{/admin/company-info(status='PENDING')}">Review</a>
      </div>
    </div>

    <div class="card p-3" th:if="${awaitingSupEndorse != null}">
      <div class="d-flex align-items-center justify-content-between">
        <div>
          <div class="text-muted fw-semibold">Logbooks: Awaiting Sup</div>
          <div class="fs-4 fw-bold" th:text="${awaitingSupEndorse} ?: 0">0</div>
        </div>
        <a class="btn btn-outline-primary" th:href="@{/admin/logbooks(status='PENDING')}">Review</a>
      </div>
    </div>

    <div class="card p-3" th:if="${awaitingLecEndorse != null}">
      <div class="d-flex align-items-center justify-content-between">
        <div>
          <div class="text-muted fw-semibold">Logbooks: Awaiting Lecturer</div>
          <div class="fs-4 fw-bold" th:text="${awaitingLecEndorse} ?: 0">0</div>
        </div>
        <a class="btn btn-outline-primary" th:href="@{/admin/logbooks}">Review</a>
      </div>
    </div>
  </section>

  <!-- Features -->
  <section class="feature-grid">
    <div class="card p-4 feature-card text-center">
      <h5><i class="bi bi-people-fill me-1"></i> Manage Students</h5>
      <p class="lead mb-3">View, edit, and delete student data.</p>
      <a th:href="@{/admin/students}" class="btn btn-primary">View Students</a>
    </div>

    <div class="card p-4 feature-card text-center">
      <h5><i class="bi bi-person-badge me-1"></i> Manage Lecturers</h5>
      <p class="lead mb-3">View, edit, and add academic supervisors.</p>
      <a th:href="@{/admin/lecturers}" class="btn btn-primary">View Lecturers</a>
    </div>

    <div class="card p-4 feature-card text-center">
      <h5><i class="bi bi-clipboard-check me-1"></i> Manage Evaluations</h5>
      <p class="lead mb-3">View and track evaluation submissions.</p>
      <a th:href="@{/admin/evaluations}" class="btn btn-primary">View Evaluations</a>
    </div>

    <div class="card p-4 feature-card text-center">
      <h5><i class="bi bi-file-text me-1"></i> Company Submissions</h5>
      <p class="lead mb-3">Verify or reject student-submitted company info.</p>
      <a th:href="@{/admin/company-info(status='PENDING')}" class="btn btn-primary">Open Queue</a>
    </div>

    <div class="card p-4 feature-card text-center">
      <h5><i class="bi bi-buildings me-1"></i> Company Master</h5>
      <p class="lead mb-3">Deduped catalog for placements & analytics.</p>
      <a th:href="@{/admin/company-master}" class="btn btn-primary">Open Master</a>
    </div>

    <div class="card p-4 feature-card text-center">
      <h5><i class="bi bi-diagram-3 me-1"></i> Placements</h5>
      <p class="lead mb-3">Approve placements and monitor status.</p>
      <div class="d-flex gap-2 justify-content-center">
        <a th:href="@{/admin/placements}" class="btn btn-primary">View Placements</a>
        <a th:href="@{/admin/placements/new}" class="btn btn-outline-primary">+ New</a>
      </div>
    </div>

    <div class="card p-4 feature-card text-center">
      <h5><i class="bi bi-file-earmark-spreadsheet me-1"></i> Export Final Grades</h5>
      <p class="lead mb-3">Compute 10/40/40/10 and download XLSX.</p>
      <form class="d-flex gap-2 justify-content-center" th:action="@{/admin/grades/export}" method="get">
        <input class="form-control" style="max-width:180px" name="semester" placeholder="e.g. 2025S1" required>
        <button class="btn btn-success"><i class="bi bi-download"></i> Export</button>
      </form>
    </div>
  </section>

  <div class="page-end"></div>
</main>

<footer class="text-center text-muted py-4 small">
  Â© <span th:text="${#dates.format(#dates.createNow(), 'yyyy')}">2025</span>, Faculty of Food Science and Technology, UPM
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
